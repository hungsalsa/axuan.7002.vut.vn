<?php
 namespace frontend\models;use Yii;class FTags extends \yii\db\ActiveRecord{public static function tableName(){return 'tags';}public function rules(){return[[['value','link','slugTag','name'],'required'],[['link'],'integer'],[['type'],'string','max'=>20],[['value','name','slugTag'],'string','max'=>255],[['type','value','link'],'unique','targetAttribute'=>['type','value','link']],];}public function attributeLabels(){return['id'=>'ID','type'=>'Type','name'=>'name','value'=>'Value','slugTag'=>'slugTag','link'=>'Link',];}public function getProOne(){return $this->hasOne(\frontend\models\product\FProduct::className(),['id'=>'link']);}public function getNewsOne(){return $this->hasOne(\frontend\models\news\FNews::className(),['id'=>'link']);}public function getAllTagsBytype($slugTag,$type='product'){return yii\helpers\ArrayHelper::map(self::find()->where('type=:type AND slugTag=:slugTag',[':type'=>$type,':slugTag'=>$slugTag])->indexBy('id')->all(),'link','link');}public function getInfoTags($slugTag,$type='product'){return self::find()->where('type=:type AND slugTag=:slugTag',[':type'=>$type,':slugTag'=>$slugTag])->asArray()->one();}public function getAllTag($keysearch,$type='product'){$data=self::find()->alias('t')->select(['t.id','t.type','t.value','t.slugTag','t.name','t.link','n.images'])->joinWith(['proOne as p'=>function(\yii\db\ActiveQuery $query){$query->select(['p.id','p.pro_name','ip.image']);$query->joinWith('imageOne ip',false);},])->joinWith(['newsOne n'],false)->where(['like','t.value','%'.$keysearch.'%',false])->orWhere(['like','t.name','%'.$keysearch.'%',false])->groupBy(['t.value'])->asArray()->all();return $data;}public function getSearch($keysearch){}}